<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="exportexcel">

	<sql id="coreSql">
		SELECT CO_NUM,TYPE,STATUS,COM_ID,CUST_ID,SALE_CENTER_ID,SLSMGR_ID,INVTY_ID,
		CRT_DATE,BORN_DATE,CRT_USER_NAME,QTY_SUM,AMT_SUM,UPDATE_TIME
		FROM CO_CO
	</sql>

	<select id="getMassDataProcess" resultType="map">
		<choose>
	 	  		<when test="v6dbtype==db2">
	 	  		    SELECT * FROM ( SELECT B.*, ROWNUMBER() OVER() AS RN FROM    (
						${sql}
					) AS B   ) AS A  
			        WHERE A.RN BETWEEN ${start} AND ${end}
	 	  		</when>
	 	  		<when test="v6dbtype==oracle">
					SELECT * FROM
					(
					   SELECT A.*, ROWNUM RN
					   FROM (
					   	${sql}
					   ) A
					   WHERE  <![CDATA[ ROWNUM <= ${end} ]]>
					)
					WHERE <![CDATA[ RN >= ${start} ]]>
	 	  		</when>
	 	 </choose>
	
	</select>
</mapper>
   
   
